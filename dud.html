<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Person Quiz</title>

    <link rel="stylesheet" type="text/css" href="quizstyle.css">
</head>
<body>

<!-- HTML structure for quiz display -->
<!-- HTML structure for quiz display -->
<div>
    <div id="quizCard">
        <div id="imageContainer">
            <img id="image" alt="Person Image">
        </div>

        <label for="nameInput">Person:</label>
        <!-- Input field for dynamic name entry -->
        <input type="text" id="nameInput" placeholder="Type to search names" oninput="showSuggestions(this.value)">
        <div id="suggestionContainer" class="suggestions"></div>

        <!-- Checkbox for auto-reveal -->
        <label for="autoRevealNameCheckbox">Auto Reveal:</label>
        <input type="checkbox" id="autoRevealNameCheckbox">

        <label for="actionInput">Action:</label>
        <input type="text" id="actionInput" placeholder="Type to search actions" oninput="showActionSuggestions(this.value)">
        <div id="actionSuggestionContainer" class="suggestions"></div>
        <label for="autoRevealActionCheckbox">Auto Reveal:</label>
        <input type="checkbox" id="autoRevealActionCheckbox">

        <!-- Object input -->
        <label for="objectInput">Object:</label>
        <input type="text" id="objectInput" placeholder="Type to search objects" oninput="showObjectSuggestions(this.value)">
        <div id="objectSuggestionContainer" class="suggestions"></div>
        <label for="autoRevealObjectCheckbox">Auto Reveal:</label>
        <input type="checkbox" id="autoRevealObjectCheckbox">

        <label for="cardInput">Card:</label>
        <input type="text" id="cardInput" placeholder="Type to search cards" oninput="showCardSuggestions(this.value)">
        <div id="cardSuggestionContainer" class="suggestions"></div>
        <label for="autoRevealcardsCheckbox">Auto Reveal:</label>
        <input type="checkbox" id="autoRevealcardsCheckbox">
    
    </div>
</div>

<script>
        let globalName; // Declare a global variable
        let globalAction;
        let globalObject;
        let globalCard;
    let data; // Declare data as a global variable
    let currentIndex = 1; // Initialize index to 1
    let checkboxStates = {
        name: false,
        action: false,
        object: false,
        paoentryid: false,
    };

    function validateInput(inputElement, correctValue) {
    const inputValueLowercase = inputElement.value.toLowerCase();

    // Check if correctValue is a string before converting to lowercase
    const correctValueLowercase = typeof correctValue === 'string' ? correctValue.toLowerCase() : correctValue;

    // Set background color to white if the input is empty, otherwise use red or green
    inputElement.style.backgroundColor = inputValueLowercase === '' ? 'white' : (inputValueLowercase === correctValueLowercase ? 'green' : 'red');

    // Add console logs to check the values
    console.log('Input Value:', inputValueLowercase);
    console.log('Correct Value:', correctValueLowercase);
    console.log('Background Color:', inputElement.style.backgroundColor);
}


    async function fetchData(index) {
        const apiUrl = `http://localhost:8080/api/cards/${index}`;

        try {
            const response = await fetch(apiUrl);
            const apiData = await response.json();

            data = apiData;
            const imageElement = document.getElementById('image');
            const nameElement = document.createElement('div');
            nameElement.textContent = data.paoentry.name;

            globalName = data.paoentry.name; // Set the value to the global variable
            globalAction = data.paoentry.action
            globalObject = data.paoentry.object
            globalCard = data.paoentry.paoentryid

            console.log(globalCard)

            // ... (your existing code) ...
        } catch (error) {
            console.error('Error fetching data:', error);
        }
    }
    

    // Function to fetch data from the API based on the shuffled array
    async function fetchData(index) {
        const apiUrl = `http://localhost:8080/api/cards/${index}`;

        try {
            const response = await fetch(apiUrl);
            const apiData = await response.json();

            data = apiData;
            const imageElement = document.getElementById('image');
            const nameElement = document.createElement('div');
            nameElement.textContent = data.paoentry.name;

            globalName = data.paoentry.name; // Set the value to the global variable
            globalAction = data.paoentry.action
            globalObject = data.paoentry.object
            globalCard = data.paoentry.paoentryid

            console.log(globalCard)


            imageElement.src = data.paoentry.image;
            imageElement.alt = data.paoentry.name + ' Image';

            document.getElementById('autoRevealNameCheckbox').addEventListener('change', () => {
                revealValue('nameInput', 'autoRevealNameCheckbox', 'name');
            });

            document.getElementById('autoRevealActionCheckbox').addEventListener('change', () => {
                revealValue('actionInput', 'autoRevealActionCheckbox', 'action');
            });

            document.getElementById('autoRevealObjectCheckbox').addEventListener('change', () => {
                revealValue('objectInput', 'autoRevealObjectCheckbox', 'object');
            });
            document.getElementById('autoRevealcardsCheckbox').addEventListener('change', () => {
                revealValue('cardInput', 'autoRevealcardsCheckbox', 'paoentryid');
            });

            document.getElementById('nameInput').addEventListener('input', (event) => {
                validateInput(event.target, data.paoentry.name);
            });

            document.getElementById('actionInput').addEventListener('input', (event) => {
                validateInput(event.target, data.paoentry.action);
            });

            document.getElementById('objectInput').addEventListener('input', (event) => {
                validateInput(event.target, data.paoentry.object);
            });
            document.getElementById('cardInput').addEventListener('input', (event) => {
                validateInput(event.target, data.paoentry.paoentryid);
            });

            // Set checkbox states based on the stored values
            document.getElementById('autoRevealNameCheckbox').checked = checkboxStates.name;
            document.getElementById('autoRevealActionCheckbox').checked = checkboxStates.action;
            document.getElementById('autoRevealObjectCheckbox').checked = checkboxStates.object;
            document.getElementById('autoRevealcardsCheckbox').checked = checkboxStates.paoentryid

            // Set input values based on checkbox states
            revealValue('nameInput', 'autoRevealNameCheckbox', 'name');
            revealValue('actionInput', 'autoRevealActionCheckbox', 'action');
            revealValue('objectInput', 'autoRevealObjectCheckbox', 'object');
            revealValue('cardInput', 'autoRevealcardsCheckbox', 'paoentryid');

            
        } catch (error) {
            console.error('Error fetching data:', error);
        }
    }

    // Function to move to the next person
    function moveToNextCard() {
        currentIndex++;
        fetchData(currentIndex);
    }

    fetchData(currentIndex); // Initial fetch
</script>


</body>
</html>
